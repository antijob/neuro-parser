{% extends 'core/dashboard/layout.html' %}

{% load static %}

{% block container %}


  {% include "core/dashboard/dashboard_stat_blocks.html" %}

  <div class="card shadow mb-4">
    <div class="card-header py-3">
      <h6 class="m-0 font-weight-bold text-primary">{{ table_title }}</h6>
    </div>

    <div class="card-body">

      <div class="input-group mb-3 row">
        <span class="col-xl-6 col-lg-12 col-md-12">
          <input id="table-search" type="text" class="form-control" placeholder="Поиск...">
        </span>

        <span class="col-xl-2 col-lg-4 col-md-12">
          <select id="region" class="form-control"></select>
        </span>
        <span class="col-xl-2 col-lg-4 col-md-12">
          <select id="category" class="form-control"></select>
        </span>

        <span class="col-xl-2 col-lg-4 col-md-12">
          <input id="dates" type="email" name="dates" class="form-control" autocomplete="off" placeholder="Даты">
        </span>
        <input type="hidden" id="start_date">
        <input type="hidden" id="end_date">

        <span class="col-xl-2 col-lg-4 col-md-12 mt-2">
          <form class="ml-2" action="{% url 'core:download_incidents_csv' %}" method="GET">
            <button type="submit" class="btn btn-sm btn-success mr-2 mb-1" value="2">
                <i class="fas fa-check d-none d-xl-inline-block"></i> Скачать CSV
            </button>
          </form>
        </span>

      </div>

      <div class="table-responsive">
        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
        </table>
      </div>
    </div>
  </div>

{% endblock %}

{% block dashboard_scripts %}
  <script src="{% static 'core/datepicker/js/bootstrap-datepicker.min.js' %}"></script>
  <link rel="stylesheet" type="text/css" href="{% static 'core/datepicker/css/bootstrap-datepicker3.min.css' %}">
  <script src="{% static 'core/js/jquery.dataTables.min.js' %}"></script>
  <script src="{% static 'core/js/dataTables.bootstrap4.min.js' %}"></script>
  <script type="text/javascript">
    const tableData = {
      assigned_only: {{ assigned_only|default_if_none:'null' }},
      status_code: {{ status_code|default_if_none:'null' }},
      mediaincidents_only: {{ mediaincidents_only|default_if_none:'null' }},
      userincidents_only: {{ userincidents_only|default_if_none:'null' }},
      active_status: {{ active_status|default_if_none:'null' }},
      show_deleted: {{ show_deleted|default_if_none:'null' }}
    };
  </script>
  <script src="{% static 'core/js/dashboard_scripts.js' %}"></script>
{% endblock %}
